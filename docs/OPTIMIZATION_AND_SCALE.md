# 效能優化與擴展計畫

> **用途**：整合查詢優化、預載策略、擴展與階段成果。  
> **更新日期**：2026年1月15日

---

## 1) 已完成優化（摘要）

- 增加 `subject` 欄位與自動推斷  
- 伺服器端過濾（grade / subject / topic / source）  
- Firestore 複合索引建議（`grade_subject_topic_id_source`, `grade_source_created_at`）  
- 查詢成本下降、網路傳輸降低  

---

## 2) 查詢優化建議

- 優先在伺服器端完成過濾  
- 客戶端僅處理 Firestore 無法支援的條件  

---

## 3) 預載與批量策略

- 避免同時大量預載（減少 429）
- 批量生成（若 API 支援）
- 設計節流/重試（指數退避）

---

## 4) 擴展規模建議（1 萬用戶）

- 建議建立索引  
- 強化緩存層  
- 分離熱/冷資料  

---

## 5) 待做

- 統一重試機制（API 路由層）
- 速率限制與併發控制
